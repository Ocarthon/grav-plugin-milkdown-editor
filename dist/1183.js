(self.webpackChunkmilkdown=self.webpackChunkmilkdown||[]).push([[1183],{32:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8075)">\n      <path\n        d="M19 5V19H5V5H19ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM14.14 11.86L11.14 15.73L9 13.14L6 17H18L14.14 11.86Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8075">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n'},1183:(e,t,n)=>{"use strict";n.d(t,{defineFeature:()=>mt});var i,l,a,o,s,r,c,d,u,h,p,g,v,m,f,w,C,y,b,k,M,H,x,L,V,I,P,_,O,T,W=n(2123),B=n(797),R=n(2845),E=n(5287),Z=n(5858),S=n(8903),N=n(7663),j=e=>{throw TypeError(e)},q=(e,t,n)=>t.has(e)||j("Cannot "+n),A=(e,t,n)=>(q(e,t,"read from private field"),n?n.call(e):t.get(e)),D=(e,t,n)=>t.has(e)?j("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),$=(e,t,n,i)=>(q(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);function Y(e,t){return Object.assign(e,{meta:{package:"@milkdown/plugin-block",...t}}),e}const F=(0,B.Qx)({filterNodes:e=>!(0,W.gi)((e=>"table"===e.type.name))(e)},"blockConfig");Y(F,{displayName:"Ctx<blockConfig>"});let K=null;const U={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};const z=W.T.ie&&W.T.ie_version<15||W.T.ios&&W.T.webkit_version<604;class G{constructor(){D(this,c),D(this,i),D(this,l),D(this,a),D(this,o),D(this,s),D(this,r),D(this,h),D(this,p),D(this,g),D(this,v),D(this,m),D(this,f),D(this,w),D(this,C),$(this,l,(()=>{if(!A(this,o))return null;const e=A(this,o),t=A(this,c,u);if(t&&R.nh.isSelectable(e.node)){const n=R.nh.create(t.state.doc,e.$pos.pos);return t.dispatch(t.state.tr.setSelection(n)),t.focus(),$(this,a,n),n}return null})),$(this,a,null),$(this,o,null),$(this,s,void 0),$(this,r,!1),$(this,p,(()=>{var e;null==(e=A(this,h))||e.call(this,{type:"hide"}),$(this,o,null)})),$(this,g,(e=>{var t;$(this,o,e),null==(t=A(this,h))||t.call(this,{type:"show",active:e})})),this.bind=(e,t)=>{$(this,i,e),$(this,h,t)},this.addEvent=e=>{e.addEventListener("mousedown",A(this,v)),e.addEventListener("mouseup",A(this,m)),e.addEventListener("dragstart",A(this,f))},this.removeEvent=e=>{e.removeEventListener("mousedown",A(this,v)),e.removeEventListener("mouseup",A(this,m)),e.removeEventListener("dragstart",A(this,f))},this.unBind=()=>{$(this,h,void 0)},$(this,v,(()=>{var e;$(this,s,null==(e=A(this,o))?void 0:e.el.getBoundingClientRect()),A(this,l).call(this)})),$(this,m,(()=>{A(this,r)?($(this,r,!1),$(this,a,null)):requestAnimationFrame((()=>{var e;A(this,s)&&(null==(e=A(this,c,u))||e.focus())}))})),$(this,f,(e=>{var t;$(this,r,!0);const n=A(this,c,u);if(!n)return;n.dom.dataset.dragging="true";const i=A(this,a);if(e.dataTransfer&&i){const l=i.content();e.dataTransfer.effectAllowed="copyMove";const{dom:a,text:s}=function(e,t){const n=[];let{openStart:i,openEnd:l,content:a}=t;for(;i>1&&l>1&&1===a.childCount&&1===a.firstChild.childCount;){i-=1,l-=1;const e=a.firstChild;n.push(e.type.name,e.attrs!==e.type.defaultAttrs?e.attrs:null),a=e.content}const o=e.someProp("clipboardSerializer")||S.ZF.fromSchema(e.state.schema),s=K||(K=document.implementation.createHTMLDocument("title")),r=s.createElement("div");r.appendChild(o.serializeFragment(a,{document:s}));let c,d=r.firstChild,u=0;for(;d&&1===d.nodeType&&(c=U[d.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){const t=s.createElement(c[e]);for(;r.firstChild;)t.appendChild(r.firstChild);r.appendChild(t),u++}d=r.firstChild}return d&&1===d.nodeType&&d.setAttribute("data-pm-slice",`${i} ${l}${u?` -${u}`:""} ${JSON.stringify(n)}`),{dom:r,text:e.someProp("clipboardTextSerializer",(n=>n(t,e)))||t.content.textBetween(0,t.content.size,"\n\n")}}(n,l);e.dataTransfer.clearData(),e.dataTransfer.setData(z?"Text":"text/html",a.innerHTML),z||e.dataTransfer.setData("text/plain",s);const r=null==(t=A(this,o))?void 0:t.el;r&&e.dataTransfer.setDragImage(r,0,0),n.dragging={slice:l,move:!0}}})),this.keydownCallback=e=>(A(this,p).call(this),$(this,r,!1),e.dom.dataset.dragging="false",!1),$(this,w,Z(((e,t)=>{if(!e.editable)return;const n=e.dom.getBoundingClientRect(),i=n.left+n.width/2;if(!(e.root.elementFromPoint(i,t.clientY)instanceof Element))return void A(this,p).call(this);const l=A(this,c,d);if(!l)return;const a=function(e,t,n){var i;if(!e.dom.parentElement)return null;try{const l=null==(i=e.posAtCoords({left:t.x,top:t.y}))?void 0:i.inside;if(null==l||l<0)return null;let a=e.state.doc.resolve(l),o=e.state.doc.nodeAt(l),s=e.nodeDOM(l);const r=t=>{const i=a.depth>=1&&0===a.index(a.depth);if(!t&&!i)return;const l=a.before(a.depth);o=e.state.doc.nodeAt(l),s=e.nodeDOM(l),a=e.state.doc.resolve(l),n(a,o)||r(!0)},c=n(a,o);return r(!c),s&&o?{node:o,$pos:a,el:s}:null}catch{return null}}(e,{x:i,y:t.clientY},l);a?A(this,g).call(this,a):A(this,p).call(this)}),200)),this.mousemoveCallback=(e,t)=>(e.composing||!e.editable||A(this,w).call(this,e,t),!1),this.dragoverCallback=(e,t)=>{var n;if(A(this,r)){const i=null==(n=A(this,c,u))?void 0:n.dom.parentElement;if(!i)return!1;const l=i.scrollHeight>i.clientHeight,a=i.getBoundingClientRect();if(l){if(i.scrollTop>0&&Math.abs(t.y-a.y)<20){const e=i.scrollTop>10?i.scrollTop-10:0;return i.scrollTop=e,!1}const n=Math.round(e.dom.getBoundingClientRect().height);if(Math.round(i.scrollTop+a.height)<n&&Math.abs(t.y-(a.height+a.y))<20){const e=i.scrollTop+10;return i.scrollTop=e,!1}}}return!1},this.dragenterCallback=e=>{e.dragging&&($(this,r,!0),e.dom.dataset.dragging="true")},this.dragleaveCallback=(e,t)=>{const n=t.clientX,i=t.clientY;(n<0||i<0||n>window.innerWidth||i>window.innerHeight)&&($(this,o,null),A(this,C).call(this,e))},this.dropCallback=e=>(A(this,C).call(this,e),!1),this.dragendCallback=e=>{A(this,C).call(this,e)},$(this,C,(e=>{$(this,r,!1),e.dom.dataset.dragging="false"}))}}i=new WeakMap,l=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakMap,r=new WeakMap,c=new WeakSet,d=function(){var e;return null==(e=A(this,i))?void 0:e.get(F.key).filterNodes},u=function(){var e;return null==(e=A(this,i))?void 0:e.get(E.kY)},h=new WeakMap,p=new WeakMap,g=new WeakMap,v=new WeakMap,m=new WeakMap,f=new WeakMap,w=new WeakMap,C=new WeakMap;const Q=(0,B.Qx)((()=>new G),"blockService"),J=(0,B.Qx)({},"blockServiceInstance");Y(Q,{displayName:"Ctx<blockService>"}),Y(J,{displayName:"Ctx<blockServiceInstance>"});const X=(0,B.Qx)({},"blockSpec");Y(X,{displayName:"Ctx<blockSpec>"});const ee=(0,B.Gf)((e=>{const t=new R.hs("MILKDOWN_BLOCK"),n=e.get(Q.key)();e.set(J.key,n);const i=e.get(X.key);return new R.k_({key:t,...i,props:{...i.props,handleDOMEvents:{drop:e=>n.dropCallback(e),pointermove:(e,t)=>n.mousemoveCallback(e,t),keydown:e=>n.keydownCallback(e),dragover:(e,t)=>n.dragoverCallback(e,t),dragleave:(e,t)=>n.dragleaveCallback(e,t),dragenter:e=>n.dragenterCallback(e),dragend:e=>n.dragendCallback(e)}}})}));Y(ee,{displayName:"Prose<block>"});class te{constructor(e){D(this,O),D(this,y),D(this,b),D(this,k),D(this,M),D(this,H),D(this,x),D(this,L),D(this,V),D(this,I),D(this,P),D(this,_),$(this,M,null),$(this,x,!1),this.update=()=>{requestAnimationFrame((()=>{if(!A(this,x))try{(e=O,t=T,q(this,e,"access private method"),t).call(this),$(this,x,!0)}catch{}var e,t}))},this.destroy=()=>{var e,t;null==(e=A(this,k))||e.unBind(),null==(t=A(this,k))||t.removeEvent(A(this,y)),A(this,y).remove()},this.show=e=>{const t=e.el,n=A(this,b).get(E.kY).dom,i={ctx:A(this,b),active:e,editorDom:n,blockDom:A(this,y)},l={contextElement:t,getBoundingClientRect:()=>A(this,P)?A(this,P).call(this,i):t.getBoundingClientRect()},a=[(0,N.UU)()];if(A(this,I)){const e=A(this,I).call(this,i),t=(0,N.cY)(e);a.push(t)}(0,N.rD)(l,A(this,y),{placement:A(this,_)?A(this,_).call(this,i):"left",middleware:[...a,...A(this,L)],...A(this,V)}).then((({x:e,y:t})=>{Object.assign(A(this,y).style,{left:`${e}px`,top:`${t}px`}),A(this,y).dataset.show="true"})).catch(console.error)},this.hide=()=>{A(this,y).dataset.show="false"},$(this,b,e.ctx),$(this,y,e.content),$(this,I,e.getOffset),$(this,P,e.getPosition),$(this,_,e.getPlacement),$(this,L,e.middleware??[]),$(this,V,e.floatingUIOptions??{}),$(this,H,e.root),this.hide()}get active(){return A(this,M)}}y=new WeakMap,b=new WeakMap,k=new WeakMap,M=new WeakMap,H=new WeakMap,x=new WeakMap,L=new WeakMap,V=new WeakMap,I=new WeakMap,P=new WeakMap,_=new WeakMap,O=new WeakSet,T=function(){const e=A(this,b).get(E.kY);(A(this,H)??e.dom.parentElement??document.body).appendChild(A(this,y));const t=A(this,b).get(J.key);t.bind(A(this,b),(e=>{"hide"===e.type?(this.hide(),$(this,M,null)):"show"===e.type&&(this.show(e.active),$(this,M,e.active))})),$(this,k,t),A(this,k).addEvent(A(this,y)),A(this,y).draggable=!0};const ne=[X,F,Q,J,ee];ne.key=X.key,ne.pluginKey=ee.key;var ie,le,ae,oe,se,re,ce,de,ue,he,pe,ge=n(9681),ve=n(641),me=n(953),fe=n(3751),we=n(8726),Ce=n(181),ye=e=>{throw TypeError(e)},be=(e,t,n)=>t.has(e)||ye("Cannot "+n),ke=(e,t,n)=>(be(e,t,"read from private field"),n?n.call(e):t.get(e)),Me=(e,t,n)=>t.has(e)?ye("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),He=(e,t,n,i)=>(be(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);class xe{constructor(e){var t;Me(this,he),Me(this,ie),Me(this,le),Me(this,ae),Me(this,oe),Me(this,se),Me(this,re),Me(this,ce),Me(this,de),Me(this,ue),He(this,ie,!1),this.onShow=()=>{},this.onHide=()=>{},He(this,ue,((e,t)=>{const{state:n,composing:i}=e,{selection:l,doc:a}=n,{ranges:o}=l,s=Math.min(...o.map((e=>e.$from.pos))),r=Math.max(...o.map((e=>e.$to.pos))),c=t&&t.doc.eq(a)&&t.selection.eq(l);if(ke(this,ie)||((ke(this,oe)??e.dom.parentElement??document.body).appendChild(this.element),He(this,ie,!0)),i||c)return;if(!ke(this,ce).call(this,e,t))return void this.hide();const d={getBoundingClientRect:()=>(0,W.MG)(e,s,r)};(0,N.rD)(d,this.element,{placement:"bottom-start",middleware:[(0,N.UU)(),(0,N.cY)(ke(this,de)),...ke(this,le)],...ke(this,ae)}).then((({x:e,y:t})=>{Object.assign(this.element.style,{left:`${e}px`,top:`${t}px`})})).catch(console.error),this.show()})),this.update=(e,t)=>{Ce(ke(this,ue),ke(this,se))(e,t)},this.getContent=(e,t=e=>"paragraph"===e.type.name)=>{const{selection:n}=e.state,{empty:i,$from:l}=n,a=e.state.selection instanceof R.U3,o=this.element.contains(document.activeElement),s=!e.hasFocus()&&!o,r=!e.editable,c=(0,W.KP)(t)(e.state.selection);if(!s&&!r&&i&&a&&c)return l.parent.textBetween(Math.max(0,l.parentOffset-500),l.parentOffset,void 0,"￼")},this.destroy=()=>{},this.show=()=>{this.element.dataset.show="true",this.onShow()},this.hide=()=>{this.element.dataset.show="false",this.onHide()},this.element=e.content,He(this,se,e.debounce??200),He(this,ce,e.shouldShow??(t=pe,be(this,he,"access private method"),t)),He(this,re,e.trigger??"/"),He(this,de,e.offset),He(this,le,e.middleware??[]),He(this,ae,e.floatingUIOptions??{}),He(this,oe,e.root)}}ie=new WeakMap,le=new WeakMap,ae=new WeakMap,oe=new WeakMap,se=new WeakMap,re=new WeakMap,ce=new WeakMap,de=new WeakMap,ue=new WeakMap,he=new WeakSet,pe=function(e){const t=this.getContent(e);if(!t)return!1;const n=t.at(-1);return!!n&&(Array.isArray(ke(this,re))?ke(this,re).includes(n):ke(this,re)===n)};var Le,Ve,Ie=n(6709),Pe=n(4256),_e=n(8998),Oe=n(4422),Te=n(4719),We=n(8889),Be=n(32),Re=n(8262),Ee=e=>{throw TypeError(e)},Ze=(e,t,n)=>t.has(e)||Ee("Cannot "+n),Se=(e,t,n)=>(Ze(e,t,"read from private field"),n?n.call(e):t.get(e)),Ne=(e,t,n)=>t.has(e)?Ee("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);class je{constructor(){Ne(this,Le,[]),this.clear=()=>{var e,t;return t=[],Ze(this,e=Le,"write to private field"),e.set(this,t),this},Ne(this,Ve,(e=>{const t={group:e,addItem:(n,i)=>{const l={key:n,...i};return e.items.push(l),t},clear:()=>(e.items=[],t)};return t})),this.addGroup=(e,t)=>{const n={key:e,label:t,items:[]};return Se(this,Le).push(n),Se(this,Ve).call(this,n)},this.getGroup=e=>{const t=Se(this,Le).find((t=>t.key===e));if(!t)throw new Error(`Group with key ${e} not found`);return Se(this,Ve).call(this,t)},this.build=()=>Se(this,Le)}}function qe(e){const{$from:t,$to:n}=e.selection,{pos:i}=t,{pos:l}=n;return e.deleteRange(i-t.node().content.size,l)}function Ae(e,t=null){return(n,i)=>{if(i){const l=function(e,t,n=null){const{from:i,to:l}=e.selection;return e.setBlockType(i,l,t,n)}(qe(n.tr),e,t);i(l.scrollIntoView())}return!0}}function De(e,t=null){return(n,i)=>{const l=function(e,t,n=null){const{$from:i,$to:l}=e.selection,a=i.blockRange(l),o=a&&(0,Re.oM)(a,t,n);return o?e.wrap(a,o):null}(qe(n.tr),e,t);return!!l&&(i&&i(l.scrollIntoView()),!0)}}function $e(e,t=null){return(n,i)=>{const l=function(e,t,n=null){const i=t.createAndFill(n);return i?e.replaceSelectionWith(i):null}(qe(n.tr),e,t);return!!l&&(i&&i(l.scrollIntoView()),!0)}}Le=new WeakMap,Ve=new WeakMap;const Ye=(0,ve.pM)({props:{ctx:{type:Object,required:!0},show:{type:Object,required:!0},filter:{type:Object,required:!0},hide:{type:Function,required:!0},config:{type:Object,required:!1}},setup({ctx:e,show:t,filter:n,hide:i,config:l}){const a=(0,me.KR)(),o=(0,ve.EW)((()=>function(e,t,n){var i,l,a,o,s,r,c,d,u,h,p,g,v,m,f,w,C,y,b,k,M,H,x,L,V,I,P,_,O,T,W,B,Z,S,N,j,q,A,D,$,Y,F,K,U,z,G,Q,J,X,ee,te,ne;const ie=null==n?void 0:n.get(Te.F),le=null==ie?void 0:ie.includes(Te.C.Latex),ae=null==ie?void 0:ie.includes(Te.C.ImageBlock),oe=null==ie?void 0:ie.includes(Te.C.Table),se=new je;se.addGroup("text",null!=(i=null==t?void 0:t.slashMenuTextGroupLabel)?i:"Text").addItem("text",{label:null!=(l=null==t?void 0:t.slashMenuTextGroupLabel)?l:"Text",icon:null!=(o=null==(a=null==t?void 0:t.slashMenuTextIcon)?void 0:a.call(t))?o:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5547)">\n      <path\n        d="M5 5.5C5 6.33 5.67 7 6.5 7H10.5V17.5C10.5 18.33 11.17 19 12 19C12.83 19 13.5 18.33 13.5 17.5V7H17.5C18.33 7 19 6.33 19 5.5C19 4.67 18.33 4 17.5 4H6.5C5.67 4 5 4.67 5 5.5Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5547">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;Ae(ge.Wf.type(e))(i,n)}}).addItem("h1",{label:null!=(s=null==t?void 0:t.slashMenuH1Label)?s:"Heading 1",icon:null!=(c=null==(r=null==t?void 0:t.slashMenuH1Icon)?void 0:r.call(t))?c:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5553)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM12 17H14V7H10V9H12V17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5553">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;Ae(ge.Y4.type(e),{level:1})(i,n)}}).addItem("h2",{label:null!=(d=null==t?void 0:t.slashMenuH2Label)?d:"Heading 2",icon:null!=(h=null==(u=null==t?void 0:t.slashMenuH2Icon)?void 0:u.call(t))?h:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5559)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15H11V13H13C14.1 13 15 12.11 15 11V9C15 7.89 14.1 7 13 7H9V9H13V11H11C9.9 11 9 11.89 9 13V17H15V15Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5559">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;Ae(ge.Y4.type(e),{level:2})(i,n)}}).addItem("h3",{label:null!=(p=null==t?void 0:t.slashMenuH3Label)?p:"Heading 3",icon:null!=(v=null==(g=null==t?void 0:t.slashMenuH3Icon)?void 0:g.call(t))?v:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_992_5565)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15V13.5C15 12.67 14.33 12 13.5 12C14.33 12 15 11.33 15 10.5V9C15 7.89 14.1 7 13 7H9V9H13V11H11V13H13V15H9V17H13C14.1 17 15 16.11 15 15Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_992_5565">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;Ae(ge.Y4.type(e),{level:3})(i,n)}}).addItem("h4",{label:null!=(m=null==t?void 0:t.slashMenuH4Label)?m:"Heading 4",icon:null!=(w=null==(f=null==t?void 0:t.slashMenuH4Icon)?void 0:f.call(t))?w:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7757)">\n      <path\n        d="M19.04 3H5.04004C3.94004 3 3.04004 3.9 3.04004 5V19C3.04004 20.1 3.94004 21 5.04004 21H19.04C20.14 21 21.04 20.1 21.04 19V5C21.04 3.9 20.14 3 19.04 3ZM19.04 19H5.04004V5H19.04V19ZM13.04 17H15.04V7H13.04V11H11.04V7H9.04004V13H13.04V17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7757">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;Ae(ge.Y4.type(e),{level:4})(i,n)}}).addItem("h5",{label:null!=(C=null==t?void 0:t.slashMenuH5Label)?C:"Heading 5",icon:null!=(b=null==(y=null==t?void 0:t.slashMenuH5Icon)?void 0:y.call(t))?b:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7760)">\n      <path\n        d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM15 15V13C15 11.89 14.1 11 13 11H11V9H15V7H9V13H13V15H9V17H13C14.1 17 15 16.11 15 15Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7760">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;Ae(ge.Y4.type(e),{level:5})(i,n)}}).addItem("h6",{label:null!=(k=null==t?void 0:t.slashMenuH6Label)?k:"Heading 6",icon:null!=(H=null==(M=null==t?void 0:t.slashMenuH6Icon)?void 0:M.call(t))?H:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7763)">\n      <path\n        d="M11 17H13C14.1 17 15 16.11 15 15V13C15 11.89 14.1 11 13 11H11V9H15V7H11C9.9 7 9 7.89 9 9V15C9 16.11 9.9 17 11 17ZM11 13H13V15H11V13ZM19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7763">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;Ae(ge.Y4.type(e),{level:6})(i,n)}}).addItem("quote",{label:null!=(x=null==t?void 0:t.slashMenuQuoteLabel)?x:"Quote",icon:null!=(V=null==(L=null==t?void 0:t.slashMenuQuoteIcon)?void 0:L.call(t))?V:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7897)">\n      <path\n        d="M7.17 17C7.68 17 8.15 16.71 8.37 16.26L9.79 13.42C9.93 13.14 10 12.84 10 12.53V8C10 7.45 9.55 7 9 7H5C4.45 7 4 7.45 4 8V12C4 12.55 4.45 13 5 13H7L5.97 15.06C5.52 15.95 6.17 17 7.17 17ZM17.17 17C17.68 17 18.15 16.71 18.37 16.26L19.79 13.42C19.93 13.14 20 12.84 20 12.53V8C20 7.45 19.55 7 19 7H15C14.45 7 14 7.45 14 8V12C14 12.55 14.45 13 15 13H17L15.97 15.06C15.52 15.95 16.17 17 17.17 17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7897">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;De(ge.JC.type(e))(i,n)}}).addItem("divider",{label:null!=(I=null==t?void 0:t.slashMenuDividerLabel)?I:"Divider",icon:null!=(_=null==(P=null==t?void 0:t.slashMenuDividerIcon)?void 0:P.call(t))?_:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_7900)">\n      <path\n        fill-rule="evenodd"\n        clip-rule="evenodd"\n        d="M19 13H5C4.45 13 4 12.55 4 12C4 11.45 4.45 11 5 11H19C19.55 11 20 11.45 20 12C20 12.55 19.55 13 19 13Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_7900">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;$e(ge.Ab.type(e))(i,n)}}),se.addGroup("list",null!=(O=null==t?void 0:t.slashMenuListGroupLabel)?O:"List").addItem("bullet-list",{label:null!=(T=null==t?void 0:t.slashMenuBulletListLabel)?T:"Bullet List",icon:null!=(B=null==(W=null==t?void 0:t.slashMenuBulletListIcon)?void 0:W.call(t))?B:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8070)">\n      <path\n        d="M4 10.5C3.17 10.5 2.5 11.17 2.5 12C2.5 12.83 3.17 13.5 4 13.5C4.83 13.5 5.5 12.83 5.5 12C5.5 11.17 4.83 10.5 4 10.5ZM4 4.5C3.17 4.5 2.5 5.17 2.5 6C2.5 6.83 3.17 7.5 4 7.5C4.83 7.5 5.5 6.83 5.5 6C5.5 5.17 4.83 4.5 4 4.5ZM4 16.5C3.17 16.5 2.5 17.18 2.5 18C2.5 18.82 3.18 19.5 4 19.5C4.82 19.5 5.5 18.82 5.5 18C5.5 17.18 4.83 16.5 4 16.5ZM8 19H20C20.55 19 21 18.55 21 18C21 17.45 20.55 17 20 17H8C7.45 17 7 17.45 7 18C7 18.55 7.45 19 8 19ZM8 13H20C20.55 13 21 12.55 21 12C21 11.45 20.55 11 20 11H8C7.45 11 7 11.45 7 12C7 12.55 7.45 13 8 13ZM7 6C7 6.55 7.45 7 8 7H20C20.55 7 21 6.55 21 6C21 5.45 20.55 5 20 5H8C7.45 5 7 5.45 7 6Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8070">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;De(ge.UM.type(e))(i,n)}}).addItem("ordered-list",{label:null!=(Z=null==t?void 0:t.slashMenuOrderedListLabel)?Z:"Ordered List",icon:null!=(N=null==(S=null==t?void 0:t.slashMenuOrderedListIcon)?void 0:S.call(t))?N:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8067)">\n      <path\n        d="M8 7H20C20.55 7 21 6.55 21 6C21 5.45 20.55 5 20 5H8C7.45 5 7 5.45 7 6C7 6.55 7.45 7 8 7ZM20 17H8C7.45 17 7 17.45 7 18C7 18.55 7.45 19 8 19H20C20.55 19 21 18.55 21 18C21 17.45 20.55 17 20 17ZM20 11H8C7.45 11 7 11.45 7 12C7 12.55 7.45 13 8 13H20C20.55 13 21 12.55 21 12C21 11.45 20.55 11 20 11ZM4.5 16H2.5C2.22 16 2 16.22 2 16.5C2 16.78 2.22 17 2.5 17H4V17.5H3.5C3.22 17.5 3 17.72 3 18C3 18.28 3.22 18.5 3.5 18.5H4V19H2.5C2.22 19 2 19.22 2 19.5C2 19.78 2.22 20 2.5 20H4.5C4.78 20 5 19.78 5 19.5V16.5C5 16.22 4.78 16 4.5 16ZM2.5 5H3V7.5C3 7.78 3.22 8 3.5 8C3.78 8 4 7.78 4 7.5V4.5C4 4.22 3.78 4 3.5 4H2.5C2.22 4 2 4.22 2 4.5C2 4.78 2.22 5 2.5 5ZM4.5 10H2.5C2.22 10 2 10.22 2 10.5C2 10.78 2.22 11 2.5 11H3.8L2.12 12.96C2.04 13.05 2 13.17 2 13.28V13.5C2 13.78 2.22 14 2.5 14H4.5C4.78 14 5 13.78 5 13.5C5 13.22 4.78 13 4.5 13H3.2L4.88 11.04C4.96 10.95 5 10.83 5 10.72V10.5C5 10.22 4.78 10 4.5 10Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8067">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;De(ge.N.type(e))(i,n)}}).addItem("todo-list",{label:null!=(j=null==t?void 0:t.slashMenuTaskListLabel)?j:"Todo List",icon:null!=(A=null==(q=null==t?void 0:t.slashMenuTaskListIcon)?void 0:q.call(t))?A:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <path\n      d="M5.66936 16.3389L9.39244 12.6158C9.54115 12.4671 9.71679 12.3937 9.91936 12.3957C10.1219 12.3976 10.2975 12.4761 10.4463 12.6312C10.5847 12.7823 10.654 12.9585 10.654 13.1599C10.654 13.3613 10.5847 13.5363 10.4463 13.6851L6.32704 17.8197C6.14627 18.0004 5.93538 18.0908 5.69436 18.0908C5.45333 18.0908 5.24243 18.0004 5.06166 17.8197L3.01744 15.7754C2.87899 15.637 2.81136 15.4629 2.81456 15.2533C2.81776 15.0437 2.88859 14.8697 3.02706 14.7312C3.16551 14.5928 3.34008 14.5235 3.55076 14.5235C3.76144 14.5235 3.93494 14.5928 4.07126 14.7312L5.66936 16.3389ZM5.66936 8.72359L9.39244 5.00049C9.54115 4.85177 9.71679 4.77838 9.91936 4.78031C10.1219 4.78223 10.2975 4.86075 10.4463 5.01586C10.5847 5.16691 10.654 5.34314 10.654 5.54454C10.654 5.74592 10.5847 5.92097 10.4463 6.06969L6.32704 10.2043C6.14627 10.3851 5.93538 10.4755 5.69436 10.4755C5.45333 10.4755 5.24243 10.3851 5.06166 10.2043L3.01744 8.16009C2.87899 8.02162 2.81136 7.84759 2.81456 7.63799C2.81776 7.42837 2.88859 7.25433 3.02706 7.11586C3.16551 6.97741 3.34008 6.90819 3.55076 6.90819C3.76144 6.90819 3.93494 6.97741 4.07126 7.11586L5.66936 8.72359ZM13.7597 16.5581C13.5472 16.5581 13.3691 16.4862 13.2253 16.3424C13.0816 16.1986 13.0097 16.0204 13.0097 15.8078C13.0097 15.5952 13.0816 15.4171 13.2253 15.2735C13.3691 15.13 13.5472 15.0582 13.7597 15.0582H20.7597C20.9722 15.0582 21.1503 15.1301 21.2941 15.2739C21.4378 15.4177 21.5097 15.5959 21.5097 15.8085C21.5097 16.0211 21.4378 16.1992 21.2941 16.3427C21.1503 16.4863 20.9722 16.5581 20.7597 16.5581H13.7597ZM13.7597 8.94276C13.5472 8.94276 13.3691 8.87085 13.2253 8.72704C13.0816 8.58324 13.0097 8.40504 13.0097 8.19244C13.0097 7.97985 13.0816 7.80177 13.2253 7.65819C13.3691 7.5146 13.5472 7.44281 13.7597 7.44281H20.7597C20.9722 7.44281 21.1503 7.51471 21.2941 7.65851C21.4378 7.80233 21.5097 7.98053 21.5097 8.19311C21.5097 8.40571 21.4378 8.5838 21.2941 8.72739C21.1503 8.87097 20.9722 8.94276 20.7597 8.94276H13.7597Z"\n    />\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;De(ge.hm.type(e),{checked:!1})(i,n)}});const re=se.addGroup("advanced",null!=(D=null==t?void 0:t.slashMenuAdvancedGroupLabel)?D:"Advanced");ae&&re.addItem("image",{label:null!=($=null==t?void 0:t.slashMenuImageLabel)?$:"Image",icon:null!=(F=null==(Y=null==t?void 0:t.slashMenuImageIcon)?void 0:Y.call(t))?F:Be.i,onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;$e(_e.YD.type(e))(i,n)}}),re.addItem("code",{label:null!=(K=null==t?void 0:t.slashMenuCodeBlockLabel)?K:"Code",icon:null!=(z=null==(U=null==t?void 0:t.slashMenuCodeBlockIcon)?void 0:U.call(t))?z:We.c,onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;$e(ge.Ay.type(e))(i,n)}}),oe&&re.addItem("table",{label:null!=(G=null==t?void 0:t.slashMenuTableLabel)?G:"Table",icon:null!=(J=null==(Q=null==t?void 0:t.slashMenuTableIcon)?void 0:Q.call(t))?J:'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8078)">\n      <path\n        d="M20 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H20C21.1 21 22 20.1 22 19V5C22 3.9 21.1 3 20 3ZM20 5V8H5V5H20ZM15 19H10V10H15V19ZM5 10H8V19H5V10ZM17 19V10H20V19H17Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8078">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;let{tr:l}=i;l=qe(l);const a=l.selection.from,o=(0,Oe.ZR)(e,3,3);l=l.replaceSelectionWith(o),n(l),requestAnimationFrame((()=>{const e=t.state.doc.content.size,i=t.state.doc.resolve(a>e?e:a<0?0:a),l=R.U3.near(i),o=t.state.tr;o.setSelection(l),n(o.scrollIntoView())}))}}),le&&re.addItem("math",{label:null!=(X=null==t?void 0:t.slashMenuMathLabel)?X:"Math",icon:null!=(te=null==(ee=null==t?void 0:t.slashMenuMathIcon)?void 0:ee.call(t))?te:We.f,onRun:e=>{const t=e.get(E.kY),{dispatch:n,state:i}=t;$e(ge.Ay.type(e),{language:"LaTex"})(i,n)}}),null==(ne=null==t?void 0:t.buildMenu)||ne.call(t,se);let ce=se.build();e&&(ce=ce.map((t=>{const n=t.items.filter((t=>t.label.toLowerCase().includes(e.toLowerCase())));return{...t,items:n}})).filter((e=>e.items.length>0)));const de=ce.flatMap((e=>e.items));return de.forEach(((e,t)=>{Object.assign(e,{index:t})})),ce.reduce(((e,t)=>{const n=e+t.items.length;return Object.assign(t,{range:[e,n]}),n}),0),{groups:ce,size:de.length}}(n.value,l,e))),s=(0,me.KR)(0),r=(0,me.KR)({x:-999,y:-999}),c=e=>{const{x:t,y:n}=e;r.value={x:t,y:n}};(0,ve.wB)([o,t],(()=>{const{size:e}=o.value;0===e&&t.value?i():s.value>=e&&(s.value=0)}));const d=(e,t)=>{const n=s.value,i="function"==typeof e?e(n):e;null==t||t(i),s.value=i},u=e=>{var t,n;const i=null==(t=a.value)?void 0:t.querySelector(`[data-index="${e}"]`),l=null==(n=a.value)?void 0:n.querySelector(".menu-groups");i&&l&&(l.scrollTop=i.offsetTop-l.offsetTop)},h=t=>{const n=o.value.groups.flatMap((e=>e.items)).at(t);n&&e&&n.onRun(e),i()},p=e=>{const{size:t,groups:n}=o.value;return"Escape"===e.key?(e.preventDefault(),void(null==i||i())):"ArrowDown"===e.key?(e.preventDefault(),d((e=>e<t-1?e+1:e),u)):"ArrowUp"===e.key?(e.preventDefault(),d((e=>e<=0?e:e-1),u)):"ArrowLeft"===e.key?(e.preventDefault(),d((e=>{const t=n.find((t=>t.range[0]<=e&&t.range[1]>e));if(!t)return e;const i=n[n.indexOf(t)-1];return i?i.range[1]-1:e}),u)):"ArrowRight"===e.key?(e.preventDefault(),d((e=>{const t=n.find((t=>t.range[0]<=e&&t.range[1]>e));if(!t)return e;const i=n[n.indexOf(t)+1];return i?i.range[0]:e}),u)):void("Enter"===e.key&&(e.preventDefault(),h(s.value)))};return(0,ve.nT)((()=>{t.value?window.addEventListener("keydown",p,{capture:!0}):window.removeEventListener("keydown",p,{capture:!0})})),(0,ve.hi)((()=>{window.removeEventListener("keydown",p,{capture:!0})})),()=>(0,ve.h)("div",{ref:a,onPointerdown:e=>e.preventDefault()},(0,ve.h)("nav",{class:"tab-group"},(0,ve.h)("ul",null,o.value.groups.map((e=>(0,ve.h)("li",{key:e.key,onPointerdown:()=>d(e.range[0],u),class:s.value>=e.range[0]&&s.value<e.range[1]?"selected":""},e.label))))),(0,ve.h)("div",{class:"menu-groups",onPointermove:c},o.value.groups.map((e=>(0,ve.h)("div",{key:e.key,class:"menu-group"},(0,ve.h)("h6",null,e.label),(0,ve.h)("ul",null,e.items.map((e=>{return(0,ve.h)("li",{key:e.key,"data-index":e.index,class:s.value===e.index?"hover":"",onPointerenter:(t=e.index,e=>{const n=r.value;if(!n)return;const{x:i,y:l}=e;i===n.x&&l===n.y||d(t)}),onPointerdown:()=>{var t,n;null==(n=null==(t=a.value)?void 0:t.querySelector(`[data-index="${e.index}"]`))||n.classList.add("active")},onPointerup:()=>{var t,n;null==(n=null==(t=a.value)?void 0:t.querySelector(`[data-index="${e.index}"]`))||n.classList.remove("active"),h(e.index)}},(0,ve.h)(Pe.I,{icon:e.icon}),(0,ve.h)("span",null,e.label));var t}))))))))}});var Fe,Ke,Ue,ze,Ge,Qe=e=>{throw TypeError(e)},Je=(e,t,n)=>t.has(e)||Qe("Cannot "+n),Xe=(e,t,n)=>(Je(e,t,"read from private field"),n?n.call(e):t.get(e)),et=(e,t,n)=>t.has(e)?Qe("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),tt=(e,t,n,i)=>(Je(e,t,"write to private field"),t.set(e,n),n);const nt=function(e){const t=(0,B.Qx)({},`${e}_SLASH_SPEC`),n=(0,B.Gf)((n=>{const i=n.get(t.key);return new R.k_({key:new R.hs(`${e}_SLASH`),...i})})),i=[t,n];return i.key=t.key,i.pluginKey=n.key,t.meta={package:"@milkdown/plugin-slash",displayName:`Ctx<slashSpec>|${e}`},n.meta={package:"@milkdown/plugin-slash",displayName:`Prose<slash>|${e}`},i}("CREPE_MENU"),it=(0,B.Qx)({show:()=>{},hide:()=>{}},"menuAPICtx");class lt{constructor(e,t,n){et(this,Fe),et(this,Ke),et(this,Ue),et(this,ze),et(this,Ge,null),this.update=e=>{Xe(this,ze).update(e)},this.show=e=>{tt(this,Ge,e),Xe(this,Ue).value="",Xe(this,ze).show()},this.hide=()=>{tt(this,Ge,null),Xe(this,ze).hide()},this.destroy=()=>{Xe(this,ze).destroy(),Xe(this,Ke).unmount(),Xe(this,Fe).remove()};const i=document.createElement("div");i.classList.add("milkdown-slash-menu");const l=(0,me.KR)(!1),a=(0,me.KR)("");tt(this,Ue,a);const o=this.hide,s=(0,fe.Ef)(Ye,{ctx:e,config:n,show:l,filter:a,hide:o});tt(this,Ke,s),s.mount(i),tt(this,Fe,i);const r=this;tt(this,ze,new xe({content:Xe(this,Fe),debounce:20,shouldShow(e){if((0,Ie.i)(e.state.selection)||(0,Ie.a)(e.state.selection))return!1;const t=this.getContent(e,(e=>["paragraph","heading"].includes(e.type.name)));if(null==t)return!1;if(!function(e){if(!(e instanceof R.U3))return!1;const{$head:t}=e,n=t.parent;return t.parentOffset===n.content.size}(e.state.selection))return!1;const n=Xe(r,Ge);return a.value=t.startsWith("/")?t.slice(1):t,"number"==typeof n?e.state.doc.resolve(n).node()===e.state.doc.resolve(e.state.selection.from).node()||(tt(r,Ge,null),!1):!!t.startsWith("/")},offset:10})),Xe(this,ze).onShow=()=>{l.value=!0},Xe(this,ze).onHide=()=>{l.value=!1},this.update(t),e.set(it.key,{show:e=>this.show(e),hide:()=>this.hide()})}}Fe=new WeakMap,Ke=new WeakMap,Ue=new WeakMap,ze=new WeakMap,Ge=new WeakMap;const at=(0,ve.pM)({props:{onAdd:{type:Function,required:!0},addIcon:{type:Function,required:!0},handleIcon:{type:Function,required:!0}},setup(e){const t=(0,me.KR)();return()=>(0,ve.h)(ve.FK,null,(0,ve.h)("div",{ref:t,class:"operation-item",onPointerdown:e=>{var n;e.preventDefault(),e.stopPropagation(),null==(n=t.value)||n.classList.add("active")},onPointerup:n=>{var i;n.preventDefault(),n.stopPropagation(),null==(i=t.value)||i.classList.remove("active"),e.onAdd()}},(0,ve.h)(Pe.I,{icon:e.addIcon()})),(0,ve.h)("div",{class:"operation-item"},(0,ve.h)(Pe.I,{icon:e.handleIcon()})))}});var ot,st,rt,ct,dt=e=>{throw TypeError(e)},ut=(e,t,n)=>t.has(e)||dt("Cannot "+n),ht=(e,t,n)=>(ut(e,t,"read from private field"),n?n.call(e):t.get(e)),pt=(e,t,n)=>t.has(e)?dt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),gt=(e,t,n,i)=>(ut(e,t,"write to private field"),t.set(e,n),n);class vt{constructor(e,t){var n,i;pt(this,ot),pt(this,st),pt(this,rt),pt(this,ct),this.update=()=>{ht(this,st).update()},this.destroy=()=>{ht(this,st).destroy(),ht(this,ot).remove(),ht(this,rt).unmount()},this.onAdd=()=>{const e=ht(this,ct),t=e.get(E.kY);t.hasFocus()||t.focus();const{state:n,dispatch:i}=t,l=ht(this,st).active;if(!l)return;const a=l.$pos.pos+l.node.nodeSize;let o=n.tr.insert(a,ge.Wf.type(e).create());o=o.setSelection(R.U3.near(o.doc.resolve(a))),i(o.scrollIntoView()),ht(this,st).hide(),e.get(it.key).show(o.selection.from)},gt(this,ct,e);const l=document.createElement("div");l.classList.add("milkdown-block-handle");const a=(0,fe.Ef)(at,{onAdd:this.onAdd,addIcon:null!=(n=null==t?void 0:t.handleAddIcon)?n:()=>we.p,handleIcon:null!=(i=null==t?void 0:t.handleDragIcon)?i:()=>'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_971_7680)">\n      <path\n        d="M11 18C11 19.1 10.1 20 9 20C7.9 20 7 19.1 7 18C7 16.9 7.9 16 9 16C10.1 16 11 16.9 11 18ZM9 10C7.9 10 7 10.9 7 12C7 13.1 7.9 14 9 14C10.1 14 11 13.1 11 12C11 10.9 10.1 10 9 10ZM9 4C7.9 4 7 4.9 7 6C7 7.1 7.9 8 9 8C10.1 8 11 7.1 11 6C11 4.9 10.1 4 9 4ZM15 8C16.1 8 17 7.1 17 6C17 4.9 16.1 4 15 4C13.9 4 13 4.9 13 6C13 7.1 13.9 8 15 8ZM15 10C13.9 10 13 10.9 13 12C13 13.1 13.9 14 15 14C16.1 14 17 13.1 17 12C17 10.9 16.1 10 15 10ZM15 16C13.9 16 13 16.9 13 18C13 19.1 13.9 20 15 20C16.1 20 17 19.1 17 18C17 16.9 16.1 16 15 16Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_971_7680">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n'});a.mount(l),gt(this,rt,a),gt(this,ot,l),gt(this,st,new te({ctx:e,content:l,getOffset:()=>16,getPlacement:({active:e,blockDom:t})=>{if("heading"===e.node.type.name)return"left";let n=0;e.node.descendants((e=>{n+=e.childCount}));const i=e.el,l=i.getBoundingClientRect(),a=t.getBoundingClientRect(),o=window.getComputedStyle(i),s=Number.parseInt(o.paddingTop,10)||0,r=Number.parseInt(o.paddingBottom,10)||0,c=l.height-s-r,d=a.height;return n>2||d<c?"left-start":"left"}})),this.update()}}ot=new WeakMap,st=new WeakMap,rt=new WeakMap,ct=new WeakMap;const mt=(e,t)=>{e.config((e=>function(e,t){e.set(F.key,{filterNodes:e=>!(0,W.gi)((e=>["table","blockquote","math_inline"].includes(e.type.name)))(e)}),e.set(ne.key,{view:()=>new vt(e,t)})}(e,t))).config((e=>function(e,t){e.set(nt.key,{view:n=>new lt(e,n,t)})}(e,t))).use(it).use(ne).use(nt)}},4256:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var i=n(4164),l=n(9418),a=n(641);function o({icon:e,class:t,onClick:n}){return(0,a.h)("span",{class:(0,i.A)("milkdown-icon",t),onPointerdown:n,ref:t=>{t&&e&&(t.innerHTML=l.A.sanitize(e.trim()))}})}o.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}}},5858:(e,t,n)=>{var i="Expected a function",l=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,s=/^0o[0-7]+$/i,r=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),h=Object.prototype.toString,p=Math.max,g=Math.min,v=function(){return u.Date.now()};function m(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function f(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(m(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=m(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(l,"");var n=o.test(e);return n||s.test(e)?r(e.slice(2),n?2:8):a.test(e)?NaN:+e}e.exports=function(e,t,n){var l=!0,a=!0;if("function"!=typeof e)throw new TypeError(i);return m(n)&&(l="leading"in n?!!n.leading:l,a="trailing"in n?!!n.trailing:a),function(e,t,n){var l,a,o,s,r,c,d=0,u=!1,h=!1,w=!0;if("function"!=typeof e)throw new TypeError(i);function C(t){var n=l,i=a;return l=a=void 0,d=t,s=e.apply(i,n)}function y(e){var n=e-c;return void 0===c||n>=t||n<0||h&&e-d>=o}function b(){var e=v();if(y(e))return k(e);r=setTimeout(b,function(e){var n=t-(e-c);return h?g(n,o-(e-d)):n}(e))}function k(e){return r=void 0,w&&l?C(e):(l=a=void 0,s)}function M(){var e=v(),n=y(e);if(l=arguments,a=this,c=e,n){if(void 0===r)return function(e){return d=e,r=setTimeout(b,t),u?C(e):s}(c);if(h)return r=setTimeout(b,t),C(c)}return void 0===r&&(r=setTimeout(b,t)),s}return t=f(t)||0,m(n)&&(u=!!n.leading,o=(h="maxWait"in n)?p(f(n.maxWait)||0,t):o,w="trailing"in n?!!n.trailing:w),M.cancel=function(){void 0!==r&&clearTimeout(r),d=0,l=c=a=r=void 0},M.flush=function(){return void 0===r?s:k(v())},M}(e,t,{leading:l,maxWait:t,trailing:a})}},6709:(e,t,n)=>{"use strict";function i(e){return"code_block"===e.$from.parent.type.name}function l(e){var t;const n=null==(t=e.$from.node(e.$from.depth-1))?void 0:t.type;return"list_item"===(null==n?void 0:n.name)}n.d(t,{a:()=>l,i:()=>i})},8726:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});const i='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_971_7676)">\n      <path\n        d="M18 13H13V18C13 18.55 12.55 19 12 19C11.45 19 11 18.55 11 18V13H6C5.45 13 5 12.55 5 12C5 11.45 5.45 11 6 11H11V6C11 5.45 11.45 5 12 5C12.55 5 13 5.45 13 6V11H18C18.55 11 19 11.45 19 12C19 12.55 18.55 13 18 13Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_971_7676">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n'},8889:(e,t,n)=>{"use strict";n.d(t,{c:()=>i,f:()=>l});const i='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="24"\n    height="24"\n    viewBox="0 0 24 24"\n  >\n    <g clip-path="url(#clip0_977_8081)">\n      <path\n        d="M9.4 16.6L4.8 12L9.4 7.4L8 6L2 12L8 18L9.4 16.6ZM14.6 16.6L19.2 12L14.6 7.4L16 6L22 12L16 18L14.6 16.6Z"\n      />\n    </g>\n    <defs>\n      <clipPath id="clip0_977_8081">\n        <rect width="24" height="24" />\n      </clipPath>\n    </defs>\n  </svg>\n',l='\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    width="32"\n    height="32"\n    viewBox="0 0 24 24"\n  >\n    <path\n      fill="currentColor"\n      d="M7 19v-.808L13.096 12L7 5.808V5h10v1.25H9.102L14.727 12l-5.625 5.77H17V19z"\n    />\n  </svg>\n'},8998:(e,t,n)=>{"use strict";n.d(t,{YD:()=>_,iH:()=>A,p0:()=>y});var i=n(797),l=n(7970),a=n(9033),o=n(9418),s=n(641),r=n(953),c=n(3751),d=n(4164),u=n(4329),h=Object.defineProperty,p=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,m=(e,t,n)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f=(e,t)=>{for(var n in t||(t={}))g.call(t,n)&&m(e,n,t[n]);if(p)for(var n of p(t))v.call(t,n)&&m(e,n,t[n]);return e};function w(e,t){return Object.assign(e,{meta:f({package:"@milkdown/components"},t)}),e}const C={imageIcon:()=>"🌌",captionIcon:()=>"💬",uploadButton:()=>"Upload file",confirmButton:()=>"Confirm ⏎",uploadPlaceholderText:"or paste the image link ...",captionPlaceholderText:"Image caption",onUpload:e=>Promise.resolve(URL.createObjectURL(e))},y=(0,i.Qx)(C,"imageBlockConfigCtx");function b(e){return(0,l.YR)(e,"paragraph",((e,t,n)=>{var i,l;if(1!==(null==(i=e.children)?void 0:i.length))return;const a=null==(l=e.children)?void 0:l[0];if(!a||"image"!==a.type)return;const{url:o,alt:s,title:r}=a,c={type:"image-block",url:o,alt:s,title:r};n.children.splice(t,1,c)}))}w(y,{displayName:"Config<image-block>",group:"ImageBlock"});const k=(0,i.lz)("remark-image-block",(()=>()=>b));w(k.plugin,{displayName:"Remark<remarkImageBlock>",group:"ImageBlock"}),w(k.options,{displayName:"RemarkConfig<remarkImageBlock>",group:"ImageBlock"});var M=Object.defineProperty,H=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,V=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))x.call(t,n)&&V(e,n,t[n]);if(H)for(var n of H(t))L.call(t,n)&&V(e,n,t[n]);return e};const P="image-block",_=(0,i.Yh)("image-block",(()=>({inline:!1,group:"block",selectable:!0,draggable:!0,isolating:!0,marks:"",atom:!0,priority:100,attrs:{src:{default:"",validate:"string"},caption:{default:"",validate:"string"},ratio:{default:1,validate:"number"}},parseDOM:[{tag:`img[data-type="${P}"]`,getAttrs:e=>{var t;if(!(e instanceof HTMLElement))throw(0,a.Ik)(e);return{src:e.getAttribute("src")||"",caption:e.getAttribute("caption")||"",ratio:Number(null!=(t=e.getAttribute("ratio"))?t:1)}}}],toDOM:e=>["img",I({"data-type":P},e.attrs)],parseMarkdown:{match:({type:e})=>"image-block"===e,runner:(e,t,n)=>{const i=t.url,l=t.title;let a=Number(t.alt||1);(Number.isNaN(a)||0===a)&&(a=1),e.addNode(n,{src:i,caption:l,ratio:a})}},toMarkdown:{match:e=>"image-block"===e.type.name,runner:(e,t)=>{e.openNode("paragraph"),e.addNode("image",void 0,void 0,{title:t.attrs.caption,url:t.attrs.src,alt:`${Number.parseFloat(t.attrs.ratio).toFixed(2)}`}),e.closeNode()}}})));function O({icon:e,class:t,onClick:n}){return(0,s.h)("span",{class:(0,d.A)("milkdown-icon",t),onPointerdown:n,ref:t=>{t&&e&&(t.innerHTML=o.A.sanitize(e.trim()))}})}w(_.node,{displayName:"NodeSchema<image-block>",group:"ImageBlock"}),O.props={icon:{type:String,required:!1},class:{type:String,required:!1},onClick:{type:Function,required:!1}};const T=(0,u.d_)("abcdefg",8),W=(0,s.pM)({props:{src:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setLink:{type:Function,required:!0},imageIcon:{type:String,required:!1},uploadButton:{type:String,required:!1},confirmButton:{type:String,required:!1},uploadPlaceholderText:{type:String,required:!1},onUpload:{type:Function,required:!0}},setup({readonly:e,src:t,setLink:n,onUpload:i,imageIcon:l,uploadButton:a,confirmButton:o,uploadPlaceholderText:c,className:u}){var h,p;const g=(0,r.KR)(!1),v=(0,r.KR)(),m=(0,r.KR)(null!=(h=t.value)?h:""),f=(0,r.KR)(T()),w=(0,r.KR)(0!==(null==(p=t.value)?void 0:p.length)),C=e=>{const t=e.target.value;w.value=0!==t.length,m.value=t},y=e=>{var t,i;"Enter"===e.key&&n(null!=(i=null==(t=v.value)?void 0:t.value)?i:"")},b=e=>{var t;const l=null==(t=e.target.files)?void 0:t[0];l&&i(l).then((e=>{e&&(n(e),w.value=!0)})).catch((e=>{console.error("An error occurred while uploading image"),console.error(e)}))};return()=>(0,s.h)("div",{class:(0,d.A)("image-edit",u)},(0,s.h)(O,{icon:l,class:"image-icon"}),(0,s.h)("div",{class:(0,d.A)("link-importer",g.value&&"focus")},(0,s.h)("input",{ref:v,draggable:"true",onDragstart:e=>{e.preventDefault(),e.stopPropagation()},disabled:e.value,class:"link-input-area",value:m.value,onInput:C,onKeydown:y,onFocus:()=>g.value=!0,onBlur:()=>g.value=!1}),!w.value&&(0,s.h)("div",{class:"placeholder"},(0,s.h)("input",{disabled:e.value,class:"hidden",id:f.value,type:"file",accept:"image/*",onChange:b}),(0,s.h)("label",{class:"uploader",for:f.value},(0,s.h)(O,{icon:a})),(0,s.h)("span",{class:"text",onClick:()=>{var e;return null==(e=v.value)?void 0:e.focus()}},c))),m.value&&(0,s.h)("div",{class:"confirm",onClick:()=>{var e,t;n(null!=(t=null==(e=v.value)?void 0:e.value)?t:"")}},(0,s.h)(O,{icon:o})))}}),B=(0,s.pM)({props:{src:{type:Object,required:!0},caption:{type:Object,required:!0},ratio:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup({src:e,caption:t,ratio:n,readonly:i,setAttr:l,config:a}){var o;const c=(0,r.KR)(),d=(0,r.KR)(),u=(0,r.KR)(Boolean(null==(o=t.value)?void 0:o.length)),h=(0,r.KR)(0),p=()=>{var e;const t=c.value;if(!t)return;const i=t.closest(".milkdown-image-block");if(!i)return;const l=i.getBoundingClientRect().width;if(!l)return;const a=t.height,o=t.width,s=o<l?a:l*(a/o),r=(s*(null!=(e=n.value)?e:1)).toFixed(2);t.dataset.origin=s.toFixed(2),t.dataset.height=r,t.style.height=`${r}px`},g=e=>{e.preventDefault(),e.stopPropagation(),i.value||(u.value=!u.value)},v=e=>{const t=e.target.value;h.value&&window.clearTimeout(h.value),h.value=window.setTimeout((()=>{l("caption",t)}),1e3)},m=e=>{const t=e.target.value;h.value&&(window.clearTimeout(h.value),h.value=0),l("caption",t)},f=e=>{e.preventDefault();const t=c.value;if(!t)return;const n=t.getBoundingClientRect().top,i=e.clientY-n,l=Number(i<100?100:i).toFixed(2);t.dataset.height=l,t.style.height=`${l}px`},w=()=>{window.removeEventListener("pointermove",f),window.removeEventListener("pointerup",w);const e=c.value;if(!e)return;const t=Number(e.dataset.origin),n=Number(e.dataset.height),i=Number.parseFloat(Number(n/t).toFixed(2));Number.isNaN(i)||l("ratio",i)},C=e=>{i.value||(e.preventDefault(),e.stopPropagation(),window.addEventListener("pointermove",f),window.addEventListener("pointerup",w))};return()=>(0,s.h)(s.FK,null,(0,s.h)("div",{class:"image-wrapper"},(0,s.h)("div",{class:"operation"},(0,s.h)("div",{class:"operation-item",onPointerdown:g},(0,s.h)(O,{icon:a.captionIcon()}))),(0,s.h)("img",{ref:c,"data-type":P,onLoad:p,src:e.value,alt:t.value}),(0,s.h)("div",{ref:d,class:"image-resize-handle",onPointerdown:C})),u.value&&(0,s.h)("input",{draggable:"true",onDragstart:e=>{e.preventDefault(),e.stopPropagation()},class:"caption-input",placeholder:null==a?void 0:a.captionPlaceholderText,onInput:v,onBlur:m,value:t.value}))}});var R=Object.defineProperty,E=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable,N=(e,t,n)=>t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const j=(0,s.pM)({props:{src:{type:Object,required:!0},caption:{type:Object,required:!0},ratio:{type:Object,required:!0},selected:{type:Object,required:!0},readonly:{type:Object,required:!0},setAttr:{type:Function,required:!0},config:{type:Object,required:!0}},setup(e){const{src:t}=e;return()=>{var n;return(null==(n=t.value)?void 0:n.length)?(0,s.h)(B,((e,t)=>{for(var n in t||(t={}))Z.call(t,n)&&N(e,n,t[n]);if(E)for(var n of E(t))S.call(t,n)&&N(e,n,t[n]);return e})({},e)):(0,s.h)(W,{src:e.src,selected:e.selected,readonly:e.readonly,setLink:t=>e.setAttr("src",t),imageIcon:e.config.imageIcon(),uploadButton:e.config.uploadButton(),confirmButton:e.config.confirmButton(),uploadPlaceholderText:e.config.uploadPlaceholderText,onUpload:e.config.onUpload})}}}),q=(0,i.m5)(_.node,(e=>(t,n,i)=>{const l=(0,r.KR)(t.attrs.src),a=(0,r.KR)(t.attrs.caption),d=(0,r.KR)(t.attrs.ratio),u=(0,r.KR)(!1),h=(0,r.KR)(!n.editable),p=e.get(y.key),g=(0,c.Ef)(j,{src:l,caption:a,ratio:d,selected:u,readonly:h,setAttr:(e,t)=>{const l=i();null!=l&&n.dispatch(n.state.tr.setNodeAttribute(l,e,"src"===e?o.A.sanitize(t):t))},config:p}),v=document.createElement("div");v.className="milkdown-image-block",g.mount(v);const m=(0,s.nT)((()=>{u.value?v.classList.add("selected"):v.classList.remove("selected")})),f=p.proxyDomURL,w=e=>{if(f){const t=f(e.attrs.src);"string"==typeof t?l.value=t:t.then((e=>{l.value=e})).catch(console.error)}else l.value=e.attrs.src;d.value=e.attrs.ratio,a.value=e.attrs.caption,h.value=!n.editable};return w(t),{dom:v,update:e=>e.type===t.type&&(w(e),!0),stopEvent:e=>e.target instanceof HTMLInputElement,selectNode:()=>{u.value=!0},deselectNode:()=>{u.value=!1},destroy:()=>{m(),g.unmount(),v.remove()}}}));w(q,{displayName:"NodeView<image-block>",group:"ImageBlock"});const A=[k,_,q,y].flat()}}]);